

<!DOCTYPE html>
<html lang="ko">
{% load static %}
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì•„ë™í•™ëŒ€ ì¡°ê¸° ë°œê²¬ ëŒ€ì‹œë³´ë“œ</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
  <header style="display: flex; justify-content: space-between; align-items: center;">
    <h1>ğŸ‘¶ ì•„ë™í•™ëŒ€ ì¡°ê¸° ë°œê²¬ ì†”ë£¨ì…˜</h1>
    <nav>
      <a href="{% url 'form_view' %}" style="margin-right: 20px;">âœï¸ ë‹¨ê±´ ì…ë ¥</a>
      <a href="{% url 'bulk_form_view' %}">ğŸ“‚ ì¼ê´„ ì—…ë¡œë“œ</a>
    </nav>
  </header>

  <!-- 3ì»¬ëŸ¼ í˜„í™© ì¹´ë“œ -->
  <section class="summary">
    <div class="card"><h2>ì´ ì•„ë™ ìˆ˜</h2><p id="total-kids">{{ total_kids }}ëª…</p></div>
    <div class="card warning"><h2>ìœ„í—˜ ì˜ì‹¬ ì•„ë™</h2><p id="danger-count">{{ danger_kids }}ëª…</p></div>
    <div class="card"><h2>ëª¨ë¸ ì •í™•ë„</h2><p>{{ last_report_date }}</p></div>
  </section>


  <!-- ì˜ˆì¸¡ ì…ë ¥ í¼ (1í–‰) -->
  <section class="input-form">
    <h2>ğŸ“Œ ì˜¤ëŠ˜ì˜ ê´€ì°° ê¸°ë¡ ì…ë ¥</h2>
    <form method="post" action="{% url 'home' %}">
      {% csrf_token %}
      <div class="form-grid">
        <div class="form-group">
          <label for="id_child_name">ì•„ë™ ì´ë¦„</label>
          {{ form.child_name }}
        </div>
        <div class="form-group">
          <label for="id_age">ë‚˜ì´</label>
          {{ form.age }}
        </div>
        <div class="form-group">
          <label for="id_gender">ì„±ë³„</label>
          {{ form.gender }}
        </div>
        <div class="form-group">
          <label for="id_attendance">ì¶œê²° ìƒíƒœ</label>
          {{ form.attendance }}
        </div>
        <div class="form-group">
          <label for="id_negative_language">ë¶€ì • ì–¸ì–´ í‘œí˜„</label>
          {{ form.negative_language }}
        </div>

        <div class="form-group">
          <label for="id_sibling">í˜•ì œìë§¤ ìˆ˜</label>
          {{ form.sibling }}
        </div>

        <div class="form-group">
          <label for="id_contact_reaction">ì‹ ì²´ ì ‘ì´‰ ë°˜ì‘</label>
          {{ form.contact_reaction }}
        </div>

        <div class="form-group">
          <label for="id_parental_aggression">ë³´í˜¸ì ê³µê²©ì„±</label>
          {{ form.parental_aggression }}
        </div>

        <div class="form-group">
          <label for="id_income_level">ì†Œë“ ìˆ˜ì¤€</label>
          {{ form.income_level }}
        </div>
        <div class="form-group">
          <label for="id_emotional_state">ë³´í˜¸ì ì •ì„œ ìƒíƒœ</label>
          {{ form.emotional_state }}
        </div>
      </div>
      <div class="form-row">
        <button type="submit">ì˜ˆì¸¡í•˜ê¸°</button>
      </div>
    </form>
  </section>

  <!-- ëˆ„ì  í…Œì´ë¸” -->
  <section class="table-section">
    <h2>ğŸ“ ê´€ì°° ë¦¬ìŠ¤íŠ¸</h2>
    </form>
    <table>
      <thead>
        <tr>
          <th>ë‚ ì§œ</th>
          <th>ì•„ë™ ì´ë¦„</th>
          <th>ì¶œê²°</th>
          <th>ë¶€ì •ì–¸ì–´</th>
          <th>ë³´í˜¸ìê³µê²©ì„±</th>
          <th>ì‹ ì²´ë°˜ì‘</th>
          <th>í˜•ì œìˆ˜</th>
          <th>ì†Œë“</th>
          <th>ì •ì„œ</th>
          <th>ìœ„í—˜ì—¬ë¶€</th>
          <th>í•™ëŒ€ ê°€ëŠ¥ì„±</th>
          <th>ì‹ ê³ </th>
        </tr>
      </thead>
      <tbody>
        {% for record in observation_list %}
        <tr>
          <td>{{ record.observation_date }}</td>
          <td>{{ record.child_name }}</td>
          <td>{{ record.attendance }}</td>
          <td>{{ record.negative_language }}</td>
          <td>{{ record.parental_aggression }}</td>
          <td>{{ record.contact_reaction }}</td>
          <td>{{ record.sibling }}</td>
          <td>{{ record.income_level }}</td>
          <td>{{ record.emotional_state }}</td>
          <td>
            {% if record.is_danger %}
              <span class="danger">ìœ„í—˜</span>
            {% else %}
              ì •ìƒ
            {% endif %}
          </td>
          <td>
            {% with record.child_name as name %}
              {% for history in predictionhistory_list %}
                {% if history.child_name == name %}
                  {{ history.predicted_prob }}%
                {% endif %}
              {% endfor %}
            {% endwith %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <form method="post" action="{% url 'reset_dashboard' %}" onsubmit="return confirm('ì •ë§ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
      {% csrf_token %}
      <button type="submit" style="margin-top: 1rem; background-color: rgb(76, 112, 231); color: white;">
        ğŸ—‘ï¸ ì´ˆê¸°í™”
      </button>
  </section>
</body>
</html>
